#!name=脚本模块快捷转换
#!desc=快速添加通用链接给Egern安装使用,依赖Script.hub;  \n⓵ 模块依赖于https://script.hub环境运行,需提前配置\n⓶ 模块限Surge/Egern使用,Loon或Stash需自行修改格式使用
#!arguments=Loon2Egern_SUFFIX:le,QuanX2Egern_SUFFIX:qe,Loon2Surge_SUFFIX:ls,QuanX2Surge_SUFFIX:qs,Surge2Loon_SUFFIX:sl,QuanX2Loon_SUFFIX:ql,STASH_SUFFIX:st,DOMAIN_HOST:kelee.one,DOMAIN_REGEX:kelee\.one,JQ_ENABLED:true
#!arguments-desc=[参数设置]\n▪︎ Loon2Egern_SUFFIX: 自定义Loon转Egern的后缀参数\n▪︎ QuanX2Egern_SUFFIX: 自定义为QuanX转Egern的后缀参数\n▪︎ Loon2Surge_SUFFIX: 自定义为Loon转Surge的后缀参数\n▪︎ QuanX2Surge_SUFFIX: 自定义为QuanX转Surge的后缀参数\n▪︎ Surge2Loon_SUFFIX: 自定义Surge转Loon的后缀参数\n▪︎ QuanX2Loon_SUFFIX: 自定义为QuanX转Loon的后缀参数\n▪︎ STASH_SUFFIX: 自定义为Stash转换链接的后缀参数\n▪︎ DOMAIN_HOST: MITM的私有域名（多个用","分隔）\n▪︎ DOMAIN_REGEX: 正则匹配的私有域名（多个用"|"分隔）\n▪︎ JQ_ENABLED: 是否支持jq语法，(true启用/false关闭）\n\n[模块说明]\n⓵ 模块依赖于https://script.hub环境运行,需提前配置\n⓶ 模块限Surge/Egern使用,Loon或Stash需自行修改格式使用\n⓷ "SUFFIX"参数按需修改,"DOMAIN"参数按域名填写
#!author=丫丫
#!icon=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Loop.png
#!homepage=https://github.com/jpcnmm2/Tool/tree/master/Egern
#!tag=增强

[URL Rewrite]
# Egern 转换
^https:\/\/((?:[a-zA-Z0-9.-]*(?:git|github|gitlab|gitee|gitcode)[a-zA-Z0-9.-]*|{{{DOMAIN_REGEX}}}))\/(.*)\/(.*)\.(js|conf|snippet|plugin|list|yaml|lpx|sgmodule).*{{{Loon2Egern_SUFFIX}}}$ egern:///modules/new?url=http://script.hub/file/_start_/https://$1/$2/$3.$4/_end_/$3.sgmodule?type=loon-plugin&target=surge-module&del=true&jqEnabled={{{JQ_ENABLED}}} 302

^https:\/\/((?:[a-zA-Z0-9.-]*(?:git|github|gitlab|gitee|gitcode)[a-zA-Z0-9.-]*|{{{DOMAIN_REGEX}}}))\/(.*)\/(.*)\.(js|conf|snippet|plugin|list|yaml|lpx|sgmodule).*{{{QuanX2Egern_SUFFIX}}}$ egern:///modules/new?url=http://script.hub/file/_start_/https://$1/$2/$3.$4/_end_/$3.sgmodule?type=qx-rewrite&target=surge-module&del=true&jqEnabled={{{JQ_ENABLED}}} 302

# Surge 转换
^https:\/\/((?:[a-zA-Z0-9.-]*(?:git|github|gitlab|gitee|gitcode)[a-zA-Z0-9.-]*|{{{DOMAIN_REGEX}}}))\/(.*)\/(.*)\.(js|conf|snippet|plugin|list|yaml|lpx|sgmodule).*{{{Loon2Surge_SUFFIX}}}$ surge:///install-module?url=http://script.hub/file/_start_/https://$1/$2/$3.$4/_end_/$3.sgmodule?type=loon-plugin&target=surge-module&del=true&jqEnabled={{{JQ_ENABLED}}} 302

^https:\/\/((?:[a-zA-Z0-9.-]*(?:git|github|gitlab|gitee|gitcode)[a-zA-Z0-9.-]*|{{{DOMAIN_REGEX}}}))\/(.*)\/(.*)\.(js|conf|snippet|plugin|list|yaml|lpx|sgmodule).*{{{QuanX2Surge_SUFFIX}}}$ surge:///install-module?url=http://script.hub/file/_start_/https://$1/$2/$3.$4/_end_/$3.sgmodule?type=qx-rewrite&target=surge-module&del=true&jqEnabled={{{JQ_ENABLED}}} 302

# Loon 转换
^https:\/\/((?:[a-zA-Z0-9.-]*(?:git|github|gitlab|gitee|gitcode)[a-zA-Z0-9.-]*|{{{DOMAIN_REGEX}}}))\/(.*)\/(.*)\.(js|conf|snippet|plugin|list|yaml|lpx|sgmodule).*{{{Surge2Loon_SUFFIX}}}$ https://www.nsloon.com/openloon/import?plugin=http://script.hub/file/_start_/https://$1/$2/$3.$4/_end_/$3.plugin?type=surge-module&target=loon-plugin&del=true&jqEnabled={{{JQ_ENABLED}}} 302

^https:\/\/((?:[a-zA-Z0-9.-]*(?:git|github|gitlab|gitee|gitcode)[a-zA-Z0-9.-]*|{{{DOMAIN_REGEX}}}))\/(.*)\/(.*)\.(js|conf|snippet|plugin|list|yaml|lpx|sgmodule).*{{{QuanX2Loon_SUFFIX}}}$ https://www.nsloon.com/openloon/import?plugin=http://script.hub/file/_start_/https://$1/$2/$3.$4/_end_/$3.plugin?type=qx-rewrite&target=loon-plugin&del=true&jqEnabled={{{JQ_ENABLED}}} 302

# Stash 转换
^https:\/\/((?:[a-zA-Z0-9.-]*(?:git|github|gitlab|gitee|gitcode)[a-zA-Z0-9.-]*|{{{DOMAIN_REGEX}}}))\/(.*)\/(.*)\.(js|conf|snippet|plugin|list|yaml|lpx|sgmodule).*{{{STASH_SUFFIX}}}$ http://script.hub/file/_start_/https://$1/$2/$3.$4_end_/$3.stoverride?type=qx-rewrite&target=stash-stoverride&del=true&jqEnabled={{{JQ_ENABLED}}} 302

[MITM]
hostname = %APPEND% raw.githubusercontent.com, gist.github.com, gist.githubusercontent.com, gitlab.com, gitee.com, gitcode.net, github.*, {{{DOMAIN_HOST}}}
